

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Model Serving &mdash; Mozhi 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato" type="text/css" />
  <link rel="stylesheet" href="../_static/css/mozhi_style.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Must Have" href="must_have_maths.html" />
    <link rel="prev" title="&lt;no title&gt;" href="language_models.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="../index.html">
                Mozhi
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="../index.html">Docs</a></li>
        
          <li><a href="study_materials.html">Mozhi Study Materials</a></li>
        
      <li>Model Serving</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="../_sources/study_materials/model_serving.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="../search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../setup/setup.html">Developers Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../setup/dev_machine.html">Setting up Developer Machine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/dev_machine.html#installations">Installations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/dev_machine.html#folder-structure">Folder Structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/docker.html">Docker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/docker.html#setup">1. Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/docker.html#misc">2. Misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/kubernetes.html">Kubernetes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/kubernetes.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/minio.html">MinIO</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/minio.html#setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/minio.html#misc">Misc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/nvidia.html">Nvidia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/prepare_data.html">Load and Prepare Demo Data for UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/api.html">mozhi API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/api.html#setup-requirements">Setup Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/api.html#local-machine">Local Machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/api.html#docker">Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/api.html#kubernetes">Kubernetes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/ui.html">mozhi UI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/ui.html#vue-reference-links">Vue Reference Links</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/ui.html#setup-requirements">Setup Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/ui.html#local-machine">Local Machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/ui.html#docker">Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/ui.html#kubernetes">Kubernetes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/ocr.html">OCR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/ocr.html#docker">Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/ocr.html#models">Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/hf_model_training.html">Hugging Face Transformers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/hf_model_training.html#preparing-the-model">Preparing the model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/hf_model_training.html#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/pt_model_training.html">Pytorch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/calamari.html">Calamari</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/calamari.html#dataset">Dataset:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/calamari.html#docker-image">Docker Image</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/databases.html">Databases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/databases.html#mysql">MYSQL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/colab.html">Google Colab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/google_drive_fuse.html">Google Drive Fuse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/postgres.html">PostgreSQL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/postgres.html#setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/postgres.html#misc">Misc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/postgres.html#psql">PSQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/postgres.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/postgres.html#create-command">Create command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/postgres.html#handy-queries">Handy queries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/demo_on_minikube.html">Minikube</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="study_materials.html">Mozhi Study Materials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dl.html">Deep Learning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dl.html#loss-functions">Loss Functions</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Model Serving</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tensorflow-model-serving">Tensorflow Model Serving</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pytorch-serve">PyTorch Serve</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="must_have_maths.html">Must Have</a><ul>
<li class="toctree-l3"><a class="reference internal" href="must_have_maths.html#kl-divergence">KL Divergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="must_have_maths.html#cross-entorpy">Cross Entorpy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="must_have_maths.html#residula-connection">Residula connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="tf.html">Tensorflow Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="transformers.html">Transformers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ner/ner.html">NER - Named Entity Recognition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ner/ner.html#what-is-ner">What is NER?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ner/ner.html#use-cases-of-ner">Use cases of NER?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ner/ner.html#methods-to-extract-ner">Methods to extract NER</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ner/intro.html">NER - Named Entity Recognition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ner/datasets.html">NER Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ner/deeplearning.html">Deep Learning Approaches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ner/papers.html">Papers Related to NER</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ner/references.html">Wild References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mozhi/mozhi.html">mozhi</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.augmenter.html">mozhi.augmenter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.bin.html">mozhi.bin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.config.html">mozhi.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.dataset.html">mozhi.dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.dataset.ner.html">mozhi.dataset.ner</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.db.html">mozhi.db</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.engine.html">mozhi.engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.engine.pytorch.html">mozhi.engine.pytorch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.engine.tf.html">mozhi.engine.tf</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.external.html">mozhi.external</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.external.experiments.html">mozhi.external.experiments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.metrics.html">mozhi.metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.model.html">mozhi.model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.model.pytorch.html">mozhi.model.pytorch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.model.tf.html">mozhi.model.tf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.model.transformers.html">mozhi.model.transformers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.nlp.html">mozhi.nlp</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.nlp.embeddings.html">mozhi.nlp.embeddings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.ocr.html">mozhi.ocr</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.ocr.text_cropping.html">mozhi.ocr.text_cropping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.ocr.text_detection.html">mozhi.ocr.text_detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.ocr.text_extraction.html">mozhi.ocr.text_extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.ocr.text_stiching.html">mozhi.ocr.text_stiching</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.pipeline.html">mozhi.pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.preprocessor.html">mozhi.preprocessor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.protocol.html">mozhi.protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.serve.html">mozhi.serve</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../mozhi/mozhi.serve.torch.html">mozhi.serve.torch</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.transformers.html">mozhi.transformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mozhi/mozhi.utils.html">mozhi.utils</a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  <section id="model-serving">
<h1>Model Serving<a class="headerlink" href="#model-serving" title="Permalink to this headline">¶</a></h1>
<section id="tensorflow-model-serving">
<h2>Tensorflow Model Serving<a class="headerlink" href="#tensorflow-model-serving" title="Permalink to this headline">¶</a></h2>
<section id="saving-and-loading-models">
<h3>Saving and Loading Models<a class="headerlink" href="#saving-and-loading-models" title="Permalink to this headline">¶</a></h3>
<p>The phrase “Saving a TensorFlow model” typically means one of two things:</p>
<ul class="simple">
<li><p><strong><a class="reference external" href="https://www.tensorflow.org/guide/checkpoint">CheckPoints</a></strong></p></li>
<li><p><strong><a class="reference external" href="https://www.tensorflow.org/guide/saved_model">SavedModel</a></strong></p>
<ul>
<li><p><strong><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/models/save_model">Keras Model</a></strong></p></li>
</ul>
</li>
</ul>
<p>Checkpoints capture the exact value of all parameters (tf.Variable objects) used by a model. Checkpoints do not contain
any description of the computation defined by the model and thus are typically only useful when source code that will
use the saved parameter values is available.</p>
<p>The SavedModel format on the other hand includes a serialized description of the computation defined by the model in
addition to the parameter values (checkpoint). Models in this format are independent of the source code that created
the model. They are thus suitable for deployment via TensorFlow Serving, TensorFlow Lite, TensorFlow.js, or programs
in other programming languages (the C, C++, Java, Go, Rust, C# etc. TensorFlow APIs).</p>
</section>
<section id="serving-models">
<h3>Serving Models<a class="headerlink" href="#serving-models" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong><a class="reference external" href="https://www.tensorflow.org/tfx/guide/serving">Tensorflow Serving</a></strong></p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="pytorch-serve">
<h2>PyTorch Serve<a class="headerlink" href="#pytorch-serve" title="Permalink to this headline">¶</a></h2>
<p>TODO: https://towardsdatascience.com/pytorch-jit-and-torchscript-c2a77bac0fff</p>
<p>PyTorch supports 2 separate modes to handle research and production environment.</p>
<ul class="simple">
<li><p>First is the <strong>Eager mode</strong>. It is built for faster prototyping, training, and experimentation.</p></li>
<li><p>Second is the <strong>Script mode</strong>. It is focused on the production use case. It has 2 components <strong>PyTorch JIT</strong> and <strong>TorchScript</strong>.</p></li>
</ul>
<p>Why do we need Script mode?</p>
<p>In one line, it gets rids of Python’s GIL and dependence on Python runtime. A nuanced explanation is as follows</p>
<p><strong>Portability</strong>
Portability allows models to be deployed in multithreaded inference servers, mobiles, and cars which is difficult with Python.
In order to achieve this PyTorch models needs to be decoupled from any specific runtime.</p>
<p><strong>Performance</strong>
PyTorch JIT is an optimizing JIT compiler for PyTorch. It uses runtime information to optimize TorchScript modules.
It can automate optimizations like layer fusion, quantization, sparsification.</p>
<section id="pytorch">
<h3><a class="reference external" href="https://pytorch.org/blog/model-serving-in-pyorch/">Pytorch</a><a class="headerlink" href="#pytorch" title="Permalink to this headline">¶</a></h3>
<p>There are three ways to export a PyTorch Lightning model for serving:</p>
<ul class="simple">
<li><p>Saving the model as a PyTorch checkpoint (*.ckpt)</p></li>
<li><p>Converting the model to ONNX</p></li>
<li><p>Exporting the model to Torchscript</p></li>
</ul>
</section>
<section id="id1">
<h3>Serving Models<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong><a class="reference external" href="https://github.com/pytorch/serve/blob/master/README.md#torchserve">TorchServe</a></strong></p></li>
<li><p>https://blog.ceshine.net/post/torchserve/</p></li>
<li><p>https://towardsdatascience.com/deploy-models-and-create-custom-handlers-in-torchserve-fc2d048fbe91</p></li>
<li><p>https://medium.com/analytics-vidhya/deploying-named-entity-recognition-model-to-production-using-torchserve-fd8cf5cff02f</p></li>
</ul>
</section>
</section>
</section>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright 2021, Mozhi.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.1.
        </div>
    </div>  

</body>
</html>